seed: 42
data:
  sequence_iterator:
    classname: SleeperTokenSequenceIterator
    kwargs:
      include_sleeper_data: true
  sequence_shuffle_buffer_size: 1024
  activations_harvester:
    layer_indices_to_harvest: [0, 1, 2, 3]
    harvest_batch_size: 16
  activations_shuffle_buffer_size: 1024
  cc_training_batch_size: 256
llm:
  base_model_repo: "roneneldan/TinyStories-Instruct-33M"
  lora_model_repo: "mars-jason-25/tiny-stories-33M-ft1"
wandb:
  project: "sleeper-model-diffing"
  entity: dmitry2-uiuc
  name: "crosscoder_D"
crosscoder:
  hidden_dim: 1536
  k: 20
  ft_init_checkpt_folder: "./.checkpoints/crosscoder_S"
  ft_init_checkpt_epoch: 20
train:
  optimizer:
    initial_learning_rate: 2.5e-5
    last_pct_of_steps: 0.2
  num_epochs: 1
  save_dir: './.checkpoints/crosscoder_D'
  save_every_n_epochs: 1
  log_every_n_steps: 50
  num_test_batches: 10
  n_batches_for_norm_estimate: 100
